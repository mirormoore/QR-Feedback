#pragma checksum "/Users/richmooremiro/Projects/Miro.WebSockets/Miro.WebSockets/Views/Session/Index.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "83985036365e83da35c0abef0854271b601a48a7"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Session_Index), @"mvc.1.0.view", @"/Views/Session/Index.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"83985036365e83da35c0abef0854271b601a48a7", @"/Views/Session/Index.cshtml")]
    public class Views_Session_Index : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<Byte[]>
    {
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.HeadTagHelper __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_HeadTagHelper;
        private global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.BodyTagHelper __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_BodyTagHelper;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 2 "/Users/richmooremiro/Projects/Miro.WebSockets/Miro.WebSockets/Views/Session/Index.cshtml"
  
    Layout = null;

#line default
#line hidden
#nullable disable
            WriteLiteral("\n<html>\n");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("head", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "83985036365e83da35c0abef0854271b601a48a72850", async() => {
                WriteLiteral(@"
    <meta charset=""utf-8"" />
    <meta http-equiv=""Cache-Control"" content=""no-cache, no-store, must-revalidate"" />
    <meta http-equiv=""Pragma"" content=""no-cache"" />
    <meta http-equiv=""Expires"" content=""0"" />
    <script src=""https://miro.com/app/static/sdk.1.1.js""></script>
    <script src=""https://code.jquery.com/jquery-1.9.1.js""></script>

    <script>

        miro.onReady(async () => {

            

            const isAuthorized = await miro.isAuthorized();

            if (isAuthorized) {

                miro.addListener(miro.enums.event.DATA_BROADCASTED, dataBroadcast);

                document.getElementById(""dimmer"").style.display = ""none"";

                document.getElementById(""auth"").style.display = ""none"";
                document.getElementById(""start"").style.display = ""block"";

                document.getElementById(""main"").style.display = ""block"";

            } else {

                document.getElementById(""dimmer"").style.display = ""none"";

                document.getElementByI");
                WriteLiteral(@"d(""auth"").style.display = ""block"";
                document.getElementById(""start"").style.display = ""none"";

                document.getElementById(""main"").style.display = ""block"";

            }

        });

        function requestAuth() {

            miro.requestAuthorization();

        }

        function getCode() {

            miro.broadcastData({
                QR: 'Active'
            });


        }

        async function dataBroadcast(event) {

            console.log(event.type);

            if (event.type == ""DATA_BROADCASTED"") {
                console.log(""we have a broadcast"");
            }

            console.log(""Broadcast Recieve: "" + event.data.conId);

            if (event.data.conId != null) {
             
                fetch(""/Session/Start"", {
                    ""method"": ""POST"",
                    ""headers"": {
                        ""Content-Type"": ""application/json""
                    },
                    ""body"": ""{\""Code\"":\"""" + event.data.conId + ""\""}""
          ");
                WriteLiteral(@"      })
                    .then(response => response.blob())
                    .then(imageBlob => {
                        const imageObjectURL = URL.createObjectURL(imageBlob);
                        console.log(imageObjectURL);
                        document.getElementById(""qrCode"").src = imageObjectURL;
                        document.getElementById(""qr"").style.display = ""block"";
                        document.getElementById(""main"").style.display = ""none"";
                    })
                    .catch(err => {
                        console.error(err);
                    });

            }
        }

        async function createQRFrame() {

            await miro.board.widgets.create({
                ""type"": ""frame"",
                ""title"": ""QR Participation"",
                ""width"": 300,
                ""height"": 300
            })

        }


    </script>
    <link rel=""stylesheet"" href=""../css/semantic.min.css"">
    <title>QR Session</title>
");
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_HeadTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.HeadTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_HeadTagHelper);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral("\n");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("body", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "83985036365e83da35c0abef0854271b601a48a77005", async() => {
                WriteLiteral("\n\n");
#nullable restore
#line 114 "/Users/richmooremiro/Projects/Miro.WebSockets/Miro.WebSockets/Views/Session/Index.cshtml"
      
        if (Model != null)
        {

#line default
#line hidden
#nullable disable
                WriteLiteral("            <h3>QR Code Successfully Generated</h3>\n            <img");
                BeginWriteAttribute("src", " src=\"", 3214, "\"", 3294, 1);
#nullable restore
#line 118 "/Users/richmooremiro/Projects/Miro.WebSockets/Miro.WebSockets/Views/Session/Index.cshtml"
WriteAttributeValue("", 3220, String.Format("data:image/png;base64,{0}", Convert.ToBase64String(Model)), 3220, 74, false);

#line default
#line hidden
#nullable disable
                EndWriteAttribute();
                WriteLiteral(" />\n");
#nullable restore
#line 119 "/Users/richmooremiro/Projects/Miro.WebSockets/Miro.WebSockets/Views/Session/Index.cshtml"
        }
        else
        {

#line default
#line hidden
#nullable disable
                WriteLiteral(@"            <div class=""ui active inverted dimmer"" id=""dimmer"">
                <div class=""ui text loader"">Loading</div>
            </div>
            <div id=""main"" class=""ui very padded text container basic segment center aligned"">
                <h2 class=""ui header"">Start a new QR Session?</h2>
                <p>This feature allows anonymous guests to dynamically create stickies on this board.</p>
                <p>After clicking start you will be presented with a QR code to share for this session.</p>
                <div id=""start"" style=""display:none"">
                    <button class=""ui green button"" onclick=""getCode();"">
                        Start Session / Show QR
                    </button>
                    <button class=""ui blue button"" style=""margin-top:10px;"" onclick=""createQRFrame()"">
                        Create QR Frame
                    </button>
                </div>
                <div id=""auth"">
                    <button class=""ui grey button"" onclick=""requestAuth()");
                WriteLiteral(";\">\n                        Authorise this Application First\n                    </button>\n                </div>\n            </div>\n");
                WriteLiteral("            <div id=\"qr\" style=\"display:none;\" class=\"ui very padded text container basic segment center aligned\">\n                <img");
                BeginWriteAttribute("src", " src=\"", 4625, "\"", 4631, 0);
                EndWriteAttribute();
                WriteLiteral(" id=\"qrCode\" width=\"250\" height=\"250\" style=\"text-align:center;\" />\n                <p>Please scan the following QR code to add content to this board</p>\n            </div>\n");
#nullable restore
#line 148 "/Users/richmooremiro/Projects/Miro.WebSockets/Miro.WebSockets/Views/Session/Index.cshtml"
        }
    

#line default
#line hidden
#nullable disable
                WriteLiteral("\n\n");
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_BodyTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.BodyTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_BodyTagHelper);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral("\n</html>");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<Byte[]> Html { get; private set; }
    }
}
#pragma warning restore 1591
